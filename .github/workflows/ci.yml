name: CI - Tests

on:
  push:
    branches: ["main"]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Basic checks
        run: |
          echo "Checking that index.html exists..."
          test -f index.html
          echo "OK: index.html exists"

      - name: Simple content check
        run: |
          echo "Checking that index.html contains <h1>TP DevOps</h1>..."
          grep -q "<h1>TP DevOps</h1>" index.html
          echo "OK: content looks correct"

      - name: Write proof artifact
        if: always()
        run: |
          echo "CI conclusion: ${{ job.status }}" > ci-proof.txt
          echo "Commit: ${{ github.sha }}" >> ci-proof.txt
          echo "Run: ${{ github.run_id }}" >> ci-proof.txt
          echo "Repo: ${{ github.repository }}" >> ci-proof.txt
          echo "Time: $(date -u)" >> ci-proof.txt

      - name: Upload proof artifact
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: ci-proof
          path: ci-proof.txt
